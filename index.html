<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>AR Aim Trainer</title>
<style>
html, body {
  margin: 0;
  padding: 0;
  overflow: hidden;
  background: black;
  width: 100%;
  height: 100%;
}

#start {
  position: fixed;
  inset: 0;
  background: black;
  color: white;
  font-size: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10;
}

video, canvas {
  position: absolute;
  width: 100vw;
  height: 100vh;
  object-fit: cover;
}
</style>
</head>
<body>

<div id="start">TAP TO START</div>
<video id="camera" autoplay playsinline></video>
<canvas id="overlay"></canvas>

<script>
const start = document.getElementById("start");
const video = document.getElementById("camera");
const canvas = document.getElementById("overlay");
const ctx = canvas.getContext("2d");

start.addEventListener("click", async () => {
  if (document.documentElement.requestFullscreen) {
    await document.documentElement.requestFullscreen();
  }
  start.style.display = "none";
  startCamera();
});

function startCamera() {
  navigator.mediaDevices.getUserMedia({
    video: { facingMode: { exact: "environment" } }
  })
  .then(stream => {
    video.srcObject = stream;
    resize();
    requestAnimationFrame(draw);
  });
}

function resize() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
window.addEventListener("resize", resize);

// AIM ANGLE (centered)
let angle = -Math.PI / 4; // 45 degrees up
let power = 800;

window.addEventListener("deviceorientation", e => {
  if (e.beta !== null) {
    angle = -((e.beta - 45) * Math.PI) / 180;
  }
});

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  const startX = canvas.width / 2;
  const startY = canvas.height * 0.85;

  let vx = Math.cos(angle) * power;
  let vy = Math.sin(angle) * power;

  let x = startX;
  let y = startY;
  let bounced = false;

  ctx.beginPath();
  ctx.moveTo(x, y);

  for (let t = 0; t < 2; t += 0.02) {
    vy += 9.8 * 30 * 0.02; // gravity
    x += vx * 0.02;
    y += vy * 0.02;

    // bounce
    if (!bounced && y > canvas.height * 0.9) {
      vy *= -0.6;
      bounced = true;
    }

    ctx.lineTo(x, y);
  }

  ctx.strokeStyle = "lime";
  ctx.lineWidth = 4;
  ctx.stroke();

  // aiming dot
  ctx.beginPath();
  ctx.arc(startX, startY, 6, 0, Math.PI * 2);
  ctx.fillStyle = "red";
  ctx.fill();

  requestAnimationFrame(draw);
}
</script>

</body>
</html>
